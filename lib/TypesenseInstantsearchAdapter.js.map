{"version":3,"sources":["../src/TypesenseInstantsearchAdapter.js"],"names":["TypesenseInstantsearchAdapter","Configuration","Typesense","search","searchForFacetValues","instantsearchRequests","adaptedResponses","requestAdapter","SearchRequestAdapter","typesenseResponse","responseAdapter","SearchResponseAdapter","results","Promise","FacetSearchRequestAdapter","FacetSearchResponseAdapter"],"mappings":"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","sourcesContent":["\"use strict\";\n\nimport { Configuration } from \"./Configuration\";\nimport Typesense from \"typesense\";\nimport { SearchRequestAdapter } from \"./SearchRequestAdapter\";\nimport { SearchResponseAdapter } from \"./SearchResponseAdapter\";\nimport { FacetSearchRequestAdapter } from \"./FacetSearchRequestAdapter\";\nimport { FacetSearchResponseAdapter } from \"./FacetSearchResponseAdapter\";\n\nexport default class TypesenseInstantsearchAdapter {\n  constructor(options) {\n    this.configuration = new Configuration(options);\n    this.configuration.validate();\n    this.typesenseClient = new Typesense.Client(this.configuration.server);\n    this.searchClient = {\n      search: instantsearchRequests =>\n        this.searchTypesenseAndAdapt(instantsearchRequests),\n      searchForFacetValues: instantsearchRequests =>\n        this.searchTypesenseForFacetValuesAndAdapt(instantsearchRequests)\n    };\n  }\n\n  async searchTypesenseAndAdapt(instantsearchRequests) {\n    const adaptedResponses = await instantsearchRequests.map(\n      async instantsearchRequest => {\n        const requestAdapter = new SearchRequestAdapter(\n          instantsearchRequest,\n          this.typesenseClient,\n          this.configuration.searchByFields\n        );\n        const typesenseResponse = await requestAdapter.request();\n        const responseAdapter = new SearchResponseAdapter(\n          typesenseResponse,\n          instantsearchRequest\n        );\n        return responseAdapter.adapt();\n      }\n    );\n\n    const results = await Promise.all(adaptedResponses);\n    return {\n      results: results\n    };\n  }\n\n  async searchTypesenseForFacetValuesAndAdapt(instantsearchRequests) {\n    const adaptedResponses = await instantsearchRequests.map(\n      async instantsearchRequest => {\n        const requestAdapter = new FacetSearchRequestAdapter(\n          instantsearchRequest,\n          this.typesenseClient,\n          this.configuration.searchByFields\n        );\n        const typesenseResponse = await requestAdapter.request();\n        const responseAdapter = new FacetSearchResponseAdapter(\n          typesenseResponse,\n          instantsearchRequest\n        );\n        return responseAdapter.adapt();\n      }\n    );\n\n    const results = await Promise.all(adaptedResponses);\n    return results;\n  }\n}\n"],"file":"TypesenseInstantsearchAdapter.js"}